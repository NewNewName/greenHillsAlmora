!function(t){Galleria.requires(1.25,"The Flickr Plugin requires Galleria version 1.2.5 or later.");var e=Galleria.utils.getScriptPath();Galleria.Flickr=function(t){this.api_key=t||"2a2ce06c15780ebeb0b706650fc890b2",this.options={max:30,imageSize:"medium",thumbSize:"thumb",sort:"interestingness-desc",description:!1,complete:function(){},backlink:!1}},Galleria.Flickr.prototype={constructor:Galleria.Flickr,search:function(t,e){return this._find({text:t},e)},tags:function(t,e){return this._find({tags:t},e)},user:function(t,e){return this._call({method:"flickr.urls.lookupUser",url:"flickr.com/photos/"+t},function(t){this._find({user_id:t.user.id,method:"flickr.people.getPublicPhotos"},e)})},set:function(t,e){return this._find({photoset_id:t,method:"flickr.photosets.getPhotos"},e)},gallery:function(t,e){return this._find({gallery_id:t,method:"flickr.galleries.getPhotos"},e)},groupsearch:function(t,e){return this._call({text:t,method:"flickr.groups.search"},function(t){this.group(t.groups.group[0].nsid,e)})},group:function(t,e){return this._find({group_id:t,method:"flickr.groups.pools.getPhotos"},e)},setOptions:function(e){return t.extend(this.options,e),this},_call:function(e,i){var n="https://api.flickr.com/services/rest/?",a=this;return e=t.extend({format:"json",jsoncallback:"?",api_key:this.api_key},e),t.each(e,function(t,e){n+="&"+t+"="+e}),t.getJSON(n,function(t){"ok"===t.stat?i.call(a,t):Galleria.raise(t.code.toString()+" "+t.stat+": "+t.message,!0)}),a},_getBig:function(t){return t.url_l?t.url_l:parseInt(t.width_o,10)>1280?"https://farm"+t.farm+".static.flickr.com/"+t.server+"/"+t.id+"_"+t.secret+"_b.jpg":t.url_o||t.url_z||t.url_m},_getSize:function(t,e){var i;switch(e){case"thumb":i=t.url_t;break;case"small":i=t.url_s;break;case"big":i=this._getBig(t);break;case"original":i=t.url_o?t.url_o:this._getBig(t);break;default:i=t.url_z||t.url_m}return i},_find:function(e,i){return e=t.extend({method:"flickr.photos.search",extras:"url_t,url_m,url_o,url_s,url_l,url_z,description",sort:this.options.sort,per_page:Math.min(this.options.max,500)},e),this._call(e,function(t){var r,o,e=[],n=t.photos?t.photos.photo:t.photoset.photo,a=n.length;for(o=0;a>o;o++)r=n[o],e.push({thumb:this._getSize(r,this.options.thumbSize),image:this._getSize(r,this.options.imageSize),big:this._getBig(r),title:n[o].title,description:this.options.description&&n[o].description?n[o].description._content:"",link:this.options.backlink?"https://flickr.com/photos/"+r.owner+"/"+r.id:""});i.call(this,e)})}};var i=Galleria.prototype.load;Galleria.prototype.load=function(){if(arguments.length||"string"!=typeof this._options.flickr)return void i.apply(this,Galleria.utils.array(arguments));var o,n=this,a=Galleria.utils.array(arguments),r=this._options.flickr.split(":"),s=t.extend({},n._options.flickrOptions),l="undefined"!=typeof s.loader?s.loader:t("<div>").css({width:48,height:48,opacity:.7,background:"#000 url("+e+"loader.gif) no-repeat 50% 50%"});if(r.length){if("function"!=typeof Galleria.Flickr.prototype[r[0]])return Galleria.raise(r[0]+" method not found in Flickr plugin"),i.apply(this,a);if(!r[1])return Galleria.raise("No flickr argument found"),i.apply(this,a);window.setTimeout(function(){n.$("target").append(l)},100),o=new Galleria.Flickr,"object"==typeof n._options.flickrOptions&&o.setOptions(n._options.flickrOptions),o[r[0]](r[1],function(t){n._data=t,l.remove(),n.trigger(Galleria.DATA),o.options.complete.call(o,t)})}else i.apply(this,a)}}(jQuery);